function AnchorMeasure()
n_variance = [1e-2; 1e-1; 1e0; 1e1; 1e2];
iteration = 1e4;
num_sample = 11;
Anchor = struct(...
    'a1',[0;10],...
    'a2',[0;0],...
    'a3',[10;0],...
    'a4',[10;10]...
    );

LSE = struct(...
    'var001',zeros(2,iteration,num_sample),...
    'var01',zeros(2,iteration,num_sample),...
    'var1',zeros(2,iteration,num_sample),...
    'var10',zeros(2,iteration,num_sample),...
    'var100',zeros(2,iteration,num_sample)...
    );
R = struct(...
    'var001',zeros(6,6,iteration,num_sample),...
    'var01',zeros(6,6,iteration,num_sample),...
    'var1',zeros(6,6,iteration,num_sample),...
    'var10',zeros(6,6,iteration,num_sample),...
    'var100',zeros(6,6,iteration,num_sample)...
    );
for iter = 1:iteration
    for num = 1:num_sample
        exactPos = [num-1;num-1];
        noise001(:,1) = [sqrt(n_variance(1,1))*randn;sqrt(n_variance(1,1))*randn;sqrt(n_variance(1,1))*randn;sqrt(n_variance(1,1))*randn];
        meas_dn_001(:,1) = ...
            [...
            norm(exactPos-Anchor.a1)+noise001(1,1)...
            norm(exactPos-Anchor.a2)+noise001(2,1)...
            norm(exactPos-Anchor.a3)+noise001(3,1)...
            norm(exactPos-Anchor.a4)+noise001(4,1)
            ];
        noise01(:,1) = [sqrt(n_variance(2,1))*randn;sqrt(n_variance(2,1))*randn;sqrt(n_variance(2,1))*randn;sqrt(n_variance(2,1))*randn];
        meas_dn_01(:,1) = ...
            [...
            norm(exactPos-Anchor.a1)+noise01(1,1)...
            norm(exactPos-Anchor.a2)+noise01(2,1)...
            norm(exactPos-Anchor.a3)+noise01(3,1)...
            norm(exactPos-Anchor.a4)+noise01(4,1)
            ];
        noise1(:,1) = [sqrt(n_variance(3,1))*randn;sqrt(n_variance(3,1))*randn;sqrt(n_variance(3,1))*randn;sqrt(n_variance(3,1))*randn];
        meas_dn_1(:,1) = ...
            [...
            norm(exactPos-Anchor.a1)+noise1(1,1)...
            norm(exactPos-Anchor.a2)+noise1(1,1)...
            norm(exactPos-Anchor.a3)+noise1(1,1)...
            norm(exactPos-Anchor.a4)+noise1(1,1)
            ];
        noise10(:,1) = [sqrt(n_variance(4,1))*randn;sqrt(n_variance(4,1))*randn;sqrt(n_variance(4,1))*randn;sqrt(n_variance(4,1))*randn];
        meas_dn_10(:,1) = ...
            [...
            norm(exactPos-Anchor.a1)+noise10(1,1)...
            norm(exactPos-Anchor.a2)+noise10(2,1)...
            norm(exactPos-Anchor.a3)+noise10(3,1)...
            norm(exactPos-Anchor.a4)+noise10(4,1)
            ];
        noise100(:,1) = [sqrt(n_variance(5))*randn;sqrt(n_variance(5))*randn;sqrt(n_variance(5))*randn;sqrt(n_variance(5))*randn];
        meas_dn_100(:,1) = ...
            [...
            norm(exactPos-Anchor.a1)+noise100(1,1)...
            norm(exactPos-Anchor.a2)+noise100(2,1)...
            norm(exactPos-Anchor.a3)+noise100(3,1)...
            norm(exactPos-Anchor.a4)+noise100(4,1)
            ];
        
        LSE.var001(:,iter,num) = ToA(meas_dn_001);
        LSE.var01(:,iter,num) = ToA(meas_dn_01);
        LSE.var1(:,iter,num) = ToA(meas_dn_1);
        LSE.var10(:,iter,num) = ToA(meas_dn_10);
        LSE.var100(:,iter,num) = ToA(meas_dn_100);
        
        R.var001(:,:,iter,num) = [4*n_variance(1,1)*(meas_dn_001(1,1)^2+meas_dn_001(2,1)^2) 4*n_variance(1,1)*(meas_dn_001(1,1)^2) 4*n_variance(1,1)*(meas_dn_001(1,1)^2) -4*n_variance(1,1)*(meas_dn_001(2,1)^2) -4*n_variance(1,1)*(meas_dn_001(2,1)^2) 0;...
            4*n_variance(1,1)*(meas_dn_001(1,1)^2) 4*n_variance(1,1)*(meas_dn_001(1,1)^2+meas_dn_001(3,1)^2) 4*n_variance(1,1)*(meas_dn_001(1,1)^2) 4*n_variance(1,1)*(meas_dn_001(3,1)^2) 0 -4*n_variance(1,1)*(meas_dn_001(3,1)^2);...
            4*n_variance(1,1)*(meas_dn_001(2,1)^2) 4*n_variance(1,1)*(meas_dn_001(1,1)^2) 4*n_variance(1,1)*(meas_dn_001(1,1)^2+meas_dn_001(4,1)^2) 0 4*n_variance(1,1)*(meas_dn_001(4,1)^2) 4*n_variance(1,1)*(meas_dn_001(4,1)^2);...
            -4*n_variance(1,1)*(meas_dn_001(2,1)^2) 4*n_variance(1,1)*(meas_dn_001(3,1)^2) 0 4*n_variance(1,1)*(meas_dn_001(2,1)^2+meas_dn_001(3,1)^2) 4*n_variance(1,1)*(meas_dn_001(2,1)^2) -4*n_variance(1,1)*(meas_dn_001(3,1)^2);...
            -4*n_variance(1,1)*(meas_dn_001(2,1)^2) 0 4*n_variance(1,1)*(meas_dn_001(4,1)^2) 4*n_variance(1,1)*(meas_dn_001(2,1)^2) 4*n_variance(1,1)*(meas_dn_001(2,1)^2+meas_dn_001(4,1)^2) 4*n_variance(1,1)*(meas_dn_001(4,1)^2);...
            0 -4*n_variance(1,1)*(meas_dn_001(3,1)^2) 4*n_variance(1,1)*(meas_dn_001(4,1)^2) -4*n_variance(1,1)*(meas_dn_001(3,1)^2) 4*n_variance(1,1)*(meas_dn_001(4,1)^2) 4*n_variance(1,1)*(meas_dn_001(3,1)^2+meas_dn_001(4,1)^2)
            ];

        R.var01(:,:,iter,num) = [4*n_variance(2,1)*(meas_dn_01(1,1)^2+meas_dn_01(2,1)^2) 4*n_variance(2,1)*(meas_dn_01(1,1)^2) 4*n_variance(2,1)*(meas_dn_01(1,1)^2) -4*n_variance(2,1)*(meas_dn_01(2,1)^2) -4*n_variance(2,1)*(meas_dn_01(2,1)^2) 0;...
            4*n_variance(2,1)*(meas_dn_01(1,1)^2) 4*n_variance(2,1)*(meas_dn_01(1,1)^2+meas_dn_01(3,1)^2) 4*n_variance(2,1)*(meas_dn_01(1,1)^2) 4*n_variance(2,1)*(meas_dn_01(3,1)^2) 0 -4*n_variance(2,1)*(meas_dn_01(3,1)^2);...
            4*n_variance(2,1)*(meas_dn_01(2,1)^2) 4*n_variance(2,1)*(meas_dn_01(1,1)^2) 4*n_variance(2,1)*(meas_dn_01(1,1)^2+meas_dn_01(4,1)^2) 0 4*n_variance(2,1)*(meas_dn_01(4,1)^2) 4*n_variance(2,1)*(meas_dn_01(4,1)^2);...
            -4*n_variance(2,1)*(meas_dn_01(2,1)^2) 4*n_variance(2,1)*(meas_dn_01(3,1)^2) 0 4*n_variance(2,1)*(meas_dn_01(2,1)^2+meas_dn_01(3,1)^2) 4*n_variance(2,1)*(meas_dn_01(2,1)^2) -4*n_variance(2,1)*(meas_dn_01(3,1)^2);...
            -4*n_variance(2,1)*(meas_dn_01(2,1)^2) 0 4*n_variance(2,1)*(meas_dn_01(4,1)^2) 4*n_variance(2,1)*(meas_dn_01(2,1)^2) 4*n_variance(2,1)*(meas_dn_01(2,1)^2+meas_dn_01(4,1)^2) 4*n_variance(2,1)*(meas_dn_01(4,1)^2);...
            0 -4*n_variance(2,1)*(meas_dn_01(3,1)^2) 4*n_variance(2,1)*(meas_dn_01(4,1)^2) -4*n_variance(2,1)*(meas_dn_01(3,1)^2) 4*n_variance(2,1)*(meas_dn_01(4,1)^2) 4*n_variance(2,1)*(meas_dn_01(3,1)^2+meas_dn_01(4,1)^2)
            ];

        R.var1(:,:,iter,num) = [4*n_variance(3,1)*(meas_dn_1(1,1)^2+meas_dn_1(2,1)^2) 4*n_variance(3,1)*(meas_dn_1(1,1)^2) 4*n_variance(3,1)*(meas_dn_1(1,1)^2) -4*n_variance(3,1)*(meas_dn_1(2,1)^2) -4*n_variance(3,1)*(meas_dn_1(2,1)^2) 0;...
            4*n_variance(3,1)*(meas_dn_1(1,1)^2) 4*n_variance(3,1)*(meas_dn_1(1,1)^2+meas_dn_1(3,1)^2) 4*n_variance(3,1)*(meas_dn_1(1,1)^2) 4*n_variance(3,1)*(meas_dn_1(3,1)^2) 0 -4*n_variance(3,1)*(meas_dn_1(3,1)^2);...
            4*n_variance(3,1)*(meas_dn_1(2,1)^2) 4*n_variance(3,1)*(meas_dn_1(1,1)^2) 4*n_variance(3,1)*(meas_dn_1(1,1)^2+meas_dn_1(4,1)^2) 0 4*n_variance(3,1)*(meas_dn_1(4,1)^2) 4*n_variance(3,1)*(meas_dn_1(4,1)^2);...
            -4*n_variance(3,1)*(meas_dn_1(2,1)^2) 4*n_variance(3,1)*(meas_dn_1(3,1)^2) 0 4*n_variance(3,1)*(meas_dn_1(2,1)^2+meas_dn_1(3,1)^2) 4*n_variance(3,1)*(meas_dn_1(2,1)^2) -4*n_variance(3,1)*(meas_dn_1(3,1)^2);...
            -4*n_variance(3,1)*(meas_dn_1(2,1)^2) 0 4*n_variance(3,1)*(meas_dn_1(4,1)^2) 4*n_variance(3,1)*(meas_dn_1(2,1)^2) 4*n_variance(3,1)*(meas_dn_1(2,1)^2+meas_dn_1(4,1)^2) 4*n_variance(3,1)*(meas_dn_1(4,1)^2);...
            0 -4*n_variance(3,1)*(meas_dn_1(3,1)^2) 4*n_variance(3,1)*(meas_dn_1(4,1)^2) -4*n_variance(3,1)*(meas_dn_1(3,1)^2) 4*n_variance(3,1)*(meas_dn_1(4,1)^2) 4*n_variance(3,1)*(meas_dn_1(3,1)^2+meas_dn_1(4,1)^2)
            ];

        R.var10(:,:,iter,num) = [4*n_variance(1,1)*(meas_dn_10(1,1)^2+meas_dn_10(2,1)^2) 4*n_variance(4,1)*(meas_dn_10(1,1)^2) 4*n_variance(4,1)*(meas_dn_10(1,1)^2) -4*n_variance(4,1)*(meas_dn_10(2,1)^2) -4*n_variance(4,1)*(meas_dn_10(2,1)^2) 0;...
            4*n_variance(4,1)*(meas_dn_10(1,1)^2) 4*n_variance(4,1)*(meas_dn_10(1,1)^2+meas_dn_10(3,1)^2) 4*n_variance(4,1)*(meas_dn_10(1,1)^2) 4*n_variance(4,1)*(meas_dn_10(3,1)^2) 0 -4*n_variance(4,1)*(meas_dn_10(3,1)^2);...
            4*n_variance(4,1)*(meas_dn_10(2,1)^2) 4*n_variance(4,1)*(meas_dn_10(1,1)^2) 4*n_variance(4,1)*(meas_dn_10(1,1)^2+meas_dn_10(4,1)^2) 0 4*n_variance(4,1)*(meas_dn_10(4,1)^2) 4*n_variance(4,1)*(meas_dn_10(4,1)^2);...
            -4*n_variance(4,1)*(meas_dn_10(2,1)^2) 4*n_variance(4,1)*(meas_dn_10(3,1)^2) 0 4*n_variance(4,1)*(meas_dn_10(2,1)^2+meas_dn_10(3,1)^2) 4*n_variance(4,1)*(meas_dn_10(2,1)^2) -4*n_variance(4,1)*(meas_dn_10(3,1)^2);...
            -4*n_variance(4,1)*(meas_dn_10(2,1)^2) 0 4*n_variance(4,1)*(meas_dn_10(4,1)^2) 4*n_variance(4,1)*(meas_dn_10(2,1)^2) 4*n_variance(4,1)*(meas_dn_10(2,1)^2+meas_dn_10(4,1)^2) 4*n_variance(4,1)*(meas_dn_10(4,1)^2);...
            0 -4*n_variance(4,1)*(meas_dn_10(3,1)^2) 4*n_variance(4,1)*(meas_dn_10(4,1)^2) -4*n_variance(4,1)*(meas_dn_10(3,1)^2) 4*n_variance(4,1)*(meas_dn_10(4,1)^2) 4*n_variance(4,1)*(meas_dn_10(3,1)^2+meas_dn_10(4,1)^2)
            ];

        R.var100(:,:,iter,num) = [4*n_variance(5,1)*(meas_dn_100(1,1)^2+meas_dn_100(2,1)^2) 4*n_variance(5,1)*(meas_dn_100(1,1)^2) 4*n_variance(5,1)*(meas_dn_100(1,1)^2) -4*n_variance(5,1)*(meas_dn_100(2,1)^2) -4*n_variance(5,1)*(meas_dn_100(2,1)^2) 0;...
            4*n_variance(5,1)*(meas_dn_100(1,1)^2) 4*n_variance(5,1)*(meas_dn_100(1,1)^2+meas_dn_100(3,1)^2) 4*n_variance(5,1)*(meas_dn_100(1,1)^2) 4*n_variance(5,1)*(meas_dn_100(3,1)^2) 0 -4*n_variance(5,1)*(meas_dn_100(3,1)^2);...
            4*n_variance(5,1)*(meas_dn_100(2,1)^2) 4*n_variance(5,1)*(meas_dn_100(1,1)^2) 4*n_variance(5,1)*(meas_dn_100(1,1)^2+meas_dn_100(4,1)^2) 0 4*n_variance(5,1)*(meas_dn_100(4,1)^2) 4*n_variance(5,1)*(meas_dn_100(4,1)^2);...
            -4*n_variance(5,1)*(meas_dn_100(2,1)^2) 4*n_variance(5,1)*(meas_dn_100(3,1)^2) 0 4*n_variance(5,1)*(meas_dn_100(2,1)^2+meas_dn_100(3,1)^2) 4*n_variance(5,1)*(meas_dn_100(2,1)^2) -4*n_variance(5,1)*(meas_dn_100(3,1)^2);...
            -4*n_variance(5,1)*(meas_dn_100(2,1)^2) 0 4*n_variance(5,1)*(meas_dn_100(4,1)^2) 4*n_variance(5,1)*(meas_dn_100(2,1)^2) 4*n_variance(5,1)*(meas_dn_100(2,1)^2+meas_dn_100(4,1)^2) 4*n_variance(5,1)*(meas_dn_100(4,1)^2);...
            0 -4*n_variance(5,1)*(meas_dn_100(3,1)^2) 4*n_variance(5,1)*(meas_dn_100(4,1)^2) -4*n_variance(5,1)*(meas_dn_100(3,1)^2) 4*n_variance(5,1)*(meas_dn_100(4,1)^2) 4*n_variance(5,1)*(meas_dn_100(3,1)^2+meas_dn_100(4,1)^2)
            ];

    end
end
Rmean = struct(...
    'var001',mean(R.var001,[3,4]),...
    'var01',mean(R.var01,[3,4]),...
    'var1',mean(R.var1,[3,4]),...
    'var10',mean(R.var10,[3,4]),...
    'var100',mean(R.var100,[3,4])...
    );
save('R.mat',"Rmean");
save('LSE.mat','LSE');
end